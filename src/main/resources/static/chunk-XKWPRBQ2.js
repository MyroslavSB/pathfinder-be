import{a as g1}from"./chunk-GJQ7G6I7.js";import{a as N}from"./chunk-YHGPMJPH.js";import{e as C,i as m1,k as b}from"./chunk-ZKJLGRTU.js";import{a as g}from"./chunk-DBFY6N4R.js";import{a as p1}from"./chunk-WDP3IY4R.js";import"./chunk-BUMFG4TH.js";import{a as u1}from"./chunk-YAG5TTVO.js";import{$a as l,Ja as d,Na as y,Ob as U,Pa as c,Pb as r1,Qb as a1,Rb as s1,T as Z,Vb as l1,Y as m,Za as u,_a as s,ab as W,ba as I,bb as v,ca as T,cb as F,db as q,e as f1,eb as X,fb as K,ga as E,gb as L,hb as e1,ib as p,jb as t1,ka as h,kb as M,ma as G,ob as w,pb as k,qb as x,rb as n1,sb as f,ta as Y,tb as O,ub as o1,vb as i1,xb as D,ya as J,yb as z,za as r}from"./chunk-PZ3LDO2P.js";var _=f1(g1());var V={coordinates:[[17.046989,51.132232],[17.047248,51.132214],[17.047676,51.132181],[17.047785,51.132156],[17.047932,51.132091],[17.048137,51.131994],[17.048172,51.131981],[17.04829,51.131938],[17.048501,51.131886],[17.048741,51.131853],[17.048973,51.131839],[17.049112,51.131845],[17.049115,51.131819],[17.049296,51.131833],[17.04951,51.13187],[17.049694,51.131916],[17.04983,51.131955],[17.049939,51.131972],[17.050049,51.131983],[17.050206,51.131979],[17.050349,51.131961],[17.050648,51.131891],[17.051064,51.131781],[17.051425,51.131674],[17.051748,51.131563],[17.051773,51.131544],[17.051786,51.131518],[17.051809,51.131487],[17.05186,51.13146],[17.052044,51.131383],[17.052332,51.131265],[17.052391,51.131239],[17.051985,51.130775],[17.051654,51.130439],[17.050923,51.130686],[17.050903,51.130576],[17.050813,51.130471],[17.05079,51.130431],[17.050678,51.130259],[17.050577,51.130237],[17.049753,51.1301],[17.049027,51.129997],[17.048951,51.129972],[17.048931,51.129965],[17.048881,51.12994],[17.048817,51.129891],[17.048773,51.12985],[17.048765,51.12984],[17.048739,51.129809],[17.048685,51.129733],[17.04864,51.129671],[17.04862,51.129642],[17.048571,51.129571],[17.048499,51.129537],[17.048405,51.129506],[17.048019,51.129392],[17.047925,51.129364],[17.047785,51.129317],[17.047545,51.129237],[17.047078,51.129087],[17.047062,51.129081],[17.047015,51.129069],[17.047033,51.129046],[17.047014,51.129018],[17.047023,51.128965],[17.047047,51.128917],[17.047081,51.128839],[17.047164,51.128675],[17.047254,51.128496],[17.047354,51.128293],[17.047355,51.128256],[17.047381,51.128198],[17.047626,51.127781],[17.047652,51.127721],[17.047801,51.127366],[17.04786,51.127224],[17.047899,51.127159],[17.047921,51.127121],[17.04783,51.127104],[17.047848,51.127067],[17.047893,51.126986],[17.048016,51.126754],[17.04805,51.126692],[17.048075,51.126649],[17.048088,51.126624],[17.048133,51.126547],[17.048164,51.126474],[17.048184,51.126432],[17.048193,51.126414],[17.048198,51.126405],[17.048261,51.126278],[17.048287,51.126236],[17.048321,51.126205],[17.048368,51.126174],[17.048411,51.126146],[17.048445,51.126124],[17.04867,51.125985],[17.048896,51.125872],[17.049428,51.125663],[17.049526,51.125636],[17.049912,51.125527],[17.050093,51.125485],[17.050124,51.125478],[17.050342,51.125428],[17.050596,51.125382],[17.050625,51.125377],[17.051472,51.125226],[17.051546,51.125212],[17.051601,51.125203],[17.051889,51.125148],[17.052007,51.125125],[17.052156,51.125086],[17.052697,51.124951],[17.052753,51.124937],[17.052836,51.124913],[17.053674,51.124672],[17.053724,51.124657],[17.053888,51.124608],[17.053955,51.124726],[17.054003,51.12481],[17.054029,51.124861],[17.054211,51.125203],[17.054029,51.124861],[17.054003,51.12481],[17.053955,51.124726],[17.053888,51.124608],[17.05383,51.124508],[17.053815,51.124483],[17.053799,51.124457],[17.053722,51.124337],[17.053645,51.124216],[17.053301,51.123674],[17.053228,51.12356],[17.053113,51.123362],[17.053098,51.123337],[17.053085,51.123313],[17.052829,51.122872],[17.052713,51.122687],[17.052665,51.122602],[17.052644,51.122566],[17.052637,51.122554],[17.052543,51.1224],[17.052519,51.122361],[17.05251,51.122346],[17.052455,51.122256],[17.052445,51.122239],[17.052525,51.1222],[17.052565,51.122181],[17.052595,51.122152],[17.052706,51.122086],[17.052665,51.122057],[17.05262,51.122023],[17.052561,51.12198],[17.052535,51.121961],[17.052477,51.12197],[17.052446,51.121913],[17.052382,51.121766],[17.052415,51.121708],[17.052554,51.12146],[17.052652,51.121286],[17.05272,51.12122],[17.05277,51.121196],[17.052823,51.121079],[17.052863,51.120897],[17.052777,51.120775],[17.052736,51.120742],[17.052633,51.120702],[17.05258,51.120672],[17.052562,51.120645],[17.052433,51.120646],[17.052427,51.120622],[17.052378,51.120599],[17.052223,51.120529],[17.052167,51.120467],[17.052144,51.120392],[17.052128,51.120314],[17.052149,51.12018],[17.052171,51.120123],[17.052212,51.120066],[17.052291,51.119974],[17.052245,51.11984],[17.052195,51.119779],[17.052129,51.119734],[17.05206,51.119696],[17.051903,51.119698],[17.051844,51.119559],[17.051673,51.119578],[17.051614,51.119586],[17.051529,51.119598],[17.051495,51.119604],[17.051484,51.119567],[17.051466,51.119504],[17.051456,51.119463],[17.051448,51.119435],[17.051362,51.119417],[17.05133,51.119421],[17.051249,51.119431],[17.051161,51.119441],[17.051136,51.119443],[17.051106,51.119317],[17.05105,51.119037],[17.051029,51.11883],[17.050645,51.118706],[17.050605,51.118692],[17.050311,51.118711],[17.050301,51.118655],[17.050072,51.118673],[17.049946,51.118607],[17.049648,51.118625],[17.04963,51.118597],[17.049615,51.118513],[17.049545,51.117986],[17.049493,51.117952],[17.049427,51.117576],[17.049356,51.117174],[17.049349,51.117142],[17.049334,51.117004],[17.049287,51.117007],[17.049246,51.11701],[17.049205,51.117013],[17.049145,51.117016],[17.049141,51.116994],[17.049136,51.116975],[17.048168,51.11703],[17.047653,51.117104],[17.047525,51.117122],[17.047242,51.117161],[17.047145,51.117174],[17.047045,51.117187],[17.046949,51.1172],[17.046971,51.117274],[17.046958,51.117276],[17.046874,51.117285],[17.046887,51.117328],[17.0469,51.117367],[17.046914,51.117411],[17.046821,51.117421],[17.046861,51.117564],[17.046907,51.117722],[17.04699,51.11802],[17.046998,51.118046],[17.04699,51.11802],[17.046905,51.118031],[17.046844,51.117811],[17.046678,51.117228],[17.046596,51.117231],[17.046367,51.117238],[17.046264,51.117243],[17.046148,51.117244],[17.046032,51.117249],[17.045757,51.117268],[17.045372,51.117299],[17.045195,51.117316],[17.045047,51.11733],[17.045004,51.117333],[17.044911,51.117342],[17.044862,51.117345],[17.044808,51.117351],[17.04477,51.117358],[17.044741,51.117342],[17.044716,51.117336],[17.04466,51.117331],[17.044619,51.11733],[17.044508,51.117326],[17.044384,51.117322],[17.044343,51.117321],[17.044297,51.117318],[17.044159,51.117309],[17.04399,51.117274],[17.043961,51.117268],[17.04393,51.117266],[17.043711,51.117252],[17.0432,51.117237],[17.043193,51.117237],[17.042821,51.117224],[17.042678,51.117221],[17.042603,51.117219],[17.042415,51.117213],[17.042359,51.117212],[17.04235,51.117213],[17.04233,51.117224],[17.04231,51.117263],[17.042293,51.117344],[17.042292,51.117392],[17.04229,51.117434],[17.04228,51.117585],[17.042278,51.117639],[17.042273,51.117868],[17.042272,51.117993],[17.042269,51.118062],[17.042264,51.118137],[17.04226,51.118285],[17.042248,51.118436],[17.04224,51.118556],[17.04223,51.118644],[17.042226,51.118682],[17.042223,51.118708],[17.042218,51.118769],[17.042205,51.118906],[17.042203,51.118952],[17.04216,51.118952],[17.042116,51.118951],[17.042062,51.11895],[17.042021,51.118947],[17.041978,51.118947],[17.041959,51.118947],[17.041939,51.118947],[17.041897,51.118947],[17.041863,51.118953],[17.041821,51.118959],[17.041775,51.118942],[17.041759,51.118924],[17.041739,51.118901],[17.041725,51.118882],[17.041693,51.118889],[17.041666,51.118892],[17.041641,51.118896],[17.041622,51.118899],[17.041606,51.118914],[17.041543,51.118971],[17.041512,51.119002],[17.041492,51.119015],[17.041553,51.119044],[17.0416,51.119065],[17.041628,51.119077],[17.0416,51.119102],[17.041546,51.119153],[17.041529,51.119172],[17.041513,51.119197],[17.041505,51.119223],[17.041476,51.119305],[17.041419,51.119429],[17.041368,51.119539],[17.041337,51.119606],[17.041315,51.119631],[17.041287,51.119647],[17.041235,51.119661],[17.041222,51.119664],[17.041018,51.119721],[17.040908,51.119772],[17.040846,51.119806],[17.04083,51.119909],[17.04083,51.119935],[17.040842,51.119983],[17.040912,51.120176],[17.040937,51.120215],[17.041247,51.120173],[17.041553,51.12013],[17.04188,51.120095],[17.041923,51.120091],[17.041941,51.120158],[17.041923,51.120091],[17.04188,51.120095],[17.041553,51.12013],[17.041247,51.120173],[17.040937,51.120215],[17.040912,51.120176],[17.040842,51.119983],[17.04083,51.119935],[17.04083,51.119909],[17.040846,51.119806],[17.040908,51.119772],[17.041018,51.119721],[17.041222,51.119664],[17.041235,51.119661],[17.041287,51.119647],[17.041315,51.119631],[17.041337,51.119606],[17.041368,51.119539],[17.041419,51.119429],[17.041476,51.119305],[17.041505,51.119223],[17.041513,51.119197],[17.041529,51.119172],[17.041546,51.119153],[17.0416,51.119102],[17.041628,51.119077],[17.041864,51.119182],[17.041925,51.119213],[17.042014,51.119347],[17.042018,51.119353],[17.042087,51.11945],[17.042157,51.119564],[17.04226,51.11971],[17.042364,51.11986],[17.042519,51.120115],[17.042642,51.120288],[17.042705,51.120391],[17.042742,51.120452],[17.042858,51.120626],[17.042946,51.120742],[17.042961,51.120765],[17.043043,51.120897],[17.043123,51.121027],[17.043232,51.121203],[17.043163,51.121233],[17.043227,51.121319],[17.043244,51.121341],[17.043261,51.121363],[17.043327,51.121415],[17.043296,51.121451],[17.043165,51.121543],[17.043132,51.121569],[17.043121,51.121576],[17.043055,51.121616],[17.043037,51.121634],[17.043018,51.121655],[17.042985,51.121686],[17.042929,51.121694],[17.042872,51.121797],[17.042739,51.122069],[17.042603,51.122336],[17.042531,51.122487],[17.042441,51.122644],[17.042392,51.122753],[17.042333,51.122888],[17.042169,51.123194],[17.042084,51.123382],[17.04196,51.12365],[17.04192,51.123728],[17.04192,51.123754],[17.041945,51.123775],[17.041938,51.123789],[17.041922,51.123821],[17.041902,51.123862],[17.041893,51.123877],[17.042317,51.123957],[17.042288,51.123999],[17.042201,51.124151],[17.042137,51.12428],[17.042001,51.124315],[17.04195,51.124355],[17.041902,51.124439],[17.041789,51.124649],[17.041776,51.124678],[17.041709,51.1248],[17.041617,51.124983],[17.041421,51.124944],[17.0413,51.12492],[17.041218,51.124903],[17.041071,51.124874],[17.040734,51.124816],[17.040591,51.124792],[17.040492,51.12502],[17.040591,51.124792],[17.040734,51.124816],[17.041071,51.124874],[17.041218,51.124903],[17.0413,51.12492],[17.041421,51.124944],[17.041617,51.124983],[17.041709,51.1248],[17.041776,51.124678],[17.041789,51.124649],[17.041902,51.124439],[17.04195,51.124355],[17.042001,51.124315],[17.042137,51.12428],[17.042201,51.124151],[17.042288,51.123999],[17.042317,51.123957],[17.042451,51.123989],[17.042485,51.123997],[17.042519,51.124004],[17.042577,51.124016],[17.042925,51.124093],[17.043425,51.124196],[17.043499,51.124318],[17.043569,51.124447],[17.043615,51.124525],[17.04374,51.124502],[17.043776,51.124516],[17.043856,51.124499],[17.043867,51.124511],[17.04402,51.12449],[17.044157,51.124522],[17.044252,51.124558],[17.044337,51.124584],[17.044458,51.124619],[17.0445,51.124619],[17.044575,51.124675],[17.044841,51.124877],[17.045077,51.124932],[17.045162,51.124957],[17.045205,51.124961],[17.045229,51.124983],[17.045274,51.125023],[17.045289,51.125036],[17.045403,51.125132],[17.045619,51.125318],[17.045665,51.125354],[17.045699,51.125384],[17.045723,51.125407],[17.045737,51.125421],[17.045848,51.125513],[17.045902,51.125538],[17.045963,51.125588],[17.046122,51.125719],[17.046211,51.125788],[17.046344,51.125869],[17.046479,51.125962],[17.046637,51.126079],[17.046707,51.126123],[17.046755,51.12615],[17.046799,51.126169],[17.046858,51.126194],[17.046975,51.126245],[17.04704,51.126271],[17.047081,51.126286],[17.047181,51.126321],[17.047367,51.12639],[17.047666,51.126495],[17.047784,51.126534],[17.047883,51.126569],[17.04789,51.12657],[17.047995,51.126603],[17.048016,51.12663],[17.048005,51.126657],[17.047967,51.126728],[17.047791,51.127055],[17.047773,51.127094],[17.047665,51.127305],[17.047645,51.127351],[17.047562,51.127553],[17.047502,51.127703],[17.047482,51.127735],[17.04723,51.128162],[17.047121,51.128336],[17.047079,51.128406],[17.047045,51.128465],[17.046932,51.128671],[17.046883,51.128762],[17.046824,51.128869],[17.046812,51.12889],[17.046762,51.12898],[17.046743,51.129015],[17.046726,51.129044],[17.046723,51.129053],[17.046725,51.129061],[17.046728,51.129077],[17.046723,51.129103],[17.046703,51.129133],[17.04666,51.129206],[17.04663,51.12925],[17.046602,51.129292],[17.046542,51.129376],[17.046507,51.129422],[17.046451,51.129466],[17.046367,51.129503],[17.046301,51.129518],[17.046171,51.129532],[17.04611,51.129537],[17.04599,51.129546],[17.045775,51.129559],[17.04578,51.129568],[17.045791,51.129587],[17.045802,51.129604],[17.045818,51.129627],[17.045826,51.129641],[17.045836,51.129657],[17.045842,51.129666],[17.045847,51.129675],[17.045852,51.129682],[17.04586,51.129692],[17.045784,51.129709],[17.045771,51.129715],[17.045757,51.129727],[17.04573,51.129752],[17.04569,51.129782],[17.045648,51.129806],[17.045603,51.129835],[17.04559,51.129843],[17.045564,51.129878],[17.045552,51.129896],[17.045547,51.129904],[17.045472,51.130006],[17.04544,51.13005],[17.045408,51.130093],[17.045366,51.130145],[17.045324,51.130213],[17.045312,51.130216],[17.045299,51.130218],[17.045285,51.13022],[17.045265,51.130227],[17.045238,51.130287],[17.045194,51.130374],[17.045134,51.130457],[17.045092,51.130516],[17.045037,51.130583],[17.045017,51.130604],[17.044991,51.130625],[17.044948,51.130674],[17.044901,51.130737],[17.044871,51.130729],[17.044827,51.130715],[17.044781,51.130703],[17.044742,51.130692],[17.044669,51.130705],[17.044617,51.130712],[17.043881,51.130496],[17.043672,51.130425],[17.043667,51.130432],[17.043661,51.13044],[17.043656,51.130446],[17.04365,51.130453],[17.043639,51.13047],[17.043619,51.130497],[17.043598,51.130527],[17.043575,51.130557],[17.043451,51.130519],[17.043208,51.130446],[17.043201,51.130444],[17.043103,51.130414],[17.042885,51.13035],[17.042752,51.130311],[17.042579,51.130263],[17.042539,51.130257],[17.042476,51.13026],[17.042453,51.130253],[17.042429,51.130246],[17.042382,51.130232],[17.042329,51.130217],[17.042315,51.130211],[17.042304,51.130241],[17.0422,51.130386],[17.04217,51.13043],[17.042095,51.130413],[17.042113,51.130359],[17.042094,51.13031],[17.042046,51.13025],[17.042022,51.130282],[17.042046,51.13025],[17.042094,51.13031],[17.042113,51.130359],[17.042095,51.130413],[17.04217,51.13043],[17.0422,51.130386],[17.042304,51.130241],[17.042315,51.130211],[17.042329,51.130217],[17.042382,51.130232],[17.042389,51.130221],[17.042417,51.130179],[17.042435,51.130151],[17.042456,51.130121],[17.042468,51.130105],[17.042474,51.130097],[17.042483,51.130085],[17.04249,51.130075],[17.042535,51.130089],[17.042586,51.130103],[17.043164,51.130278],[17.043606,51.130406],[17.043672,51.130425],[17.043881,51.130496],[17.044617,51.130712],[17.044669,51.130705],[17.044742,51.130692],[17.044781,51.130703],[17.044827,51.130715],[17.044871,51.130729],[17.044901,51.130737],[17.044948,51.130674],[17.044991,51.130625],[17.045017,51.130604],[17.045037,51.130583],[17.045092,51.130516],[17.045134,51.130457],[17.045194,51.130374],[17.045238,51.130287],[17.045265,51.130227],[17.045285,51.13022],[17.045299,51.130218],[17.045312,51.130216],[17.045324,51.130213],[17.045366,51.130145],[17.045408,51.130093],[17.04544,51.13005],[17.045472,51.130006],[17.045547,51.129904],[17.045552,51.129896],[17.045564,51.129878],[17.04559,51.129843],[17.045603,51.129835],[17.045648,51.129806],[17.04569,51.129782],[17.04573,51.129752],[17.045757,51.129727],[17.045771,51.129715],[17.045784,51.129709],[17.04586,51.129692],[17.045852,51.129682],[17.045847,51.129675],[17.045842,51.129666],[17.045836,51.129657],[17.045826,51.129641],[17.045853,51.129636],[17.045947,51.129618],[17.046039,51.129605],[17.046127,51.129582],[17.046184,51.129576],[17.046192,51.129576],[17.046319,51.129563],[17.046366,51.129555],[17.046406,51.129539],[17.046463,51.129517],[17.046482,51.129509],[17.046531,51.129479],[17.046596,51.129414],[17.046648,51.129334],[17.046695,51.129261],[17.046774,51.129127],[17.04683,51.129029],[17.046895,51.128903],[17.046905,51.128885],[17.046915,51.128868],[17.047132,51.128477],[17.04716,51.128428],[17.047165,51.128418],[17.047176,51.1284],[17.047269,51.128235],[17.047301,51.128178],[17.047539,51.127753],[17.047566,51.127704],[17.047609,51.127606],[17.047622,51.127572],[17.047712,51.127367],[17.047751,51.127274],[17.047811,51.127142],[17.04783,51.127104],[17.047848,51.127067],[17.047893,51.126986],[17.048016,51.126754],[17.04805,51.126692],[17.048075,51.126649],[17.048029,51.126634],[17.048016,51.12663],[17.047995,51.126603],[17.04789,51.12657],[17.047883,51.126569],[17.047941,51.126485],[17.04799,51.126413],[17.047951,51.126407],[17.04787,51.126378],[17.047385,51.126202],[17.047083,51.126052],[17.046842,51.125924],[17.046757,51.125863],[17.046628,51.125748],[17.046556,51.125679],[17.046541,51.125665],[17.046586,51.125646],[17.04674,51.125577],[17.046754,51.125569],[17.046778,51.125557],[17.046902,51.125495],[17.046959,51.125422],[17.047041,51.125384],[17.047005,51.125345],[17.046987,51.125327],[17.047019,51.125314],[17.046997,51.125298],[17.04699,51.125291],[17.046941,51.125245]],type:"LineString",duration:7771.834,distance:5659.811};var h1=["mapContainer"],$=[-98.54818,40.00811],c1=3.2,P=class i{mapContainer;center=h($);zoom=h(c1);showUserLocation=!0;route=V;markers=[];centerChange=new c;zoomChange=new c;mapClicked=new c;geoService=m(N);destroyRef=m(E);platformId=m(Y);userMarker;routeLayerId="default-route-layer";mapMarkers=new Map;map;ngOnInit(){l1(this.platformId)&&(_.default.workerUrl="/assets/mapbox-gl/mapbox-gl-csp-worker.js",_.default.accessToken="pk.eyJ1IjoibXlyb3NsYXYtc2IiLCJhIjoiY21manU4d3B1MDZ4aDJpczkxbGkybHEyeSJ9.gDxEBY76csHtpQ3YMKjpjQ",this.setUserLocation())}ngOnChanges(e){e.markers&&this.map&&this.syncMarkers(this.markers)}setUserLocation(){this.geoService.getCurrentPosition().pipe(g(this.destroyRef)).subscribe({next:e=>{console.log(e);let t=[e.coords.longitude,e.coords.latitude];this.initMap(t)},error:()=>{this.initMap($)}})}initMap(e){let t=e===$?c1:14;this.center.set(e),this.centerChange.emit(e),this.zoom.set(t),this.zoomChange.emit(t),this.map=new _.default.Map({container:this.mapContainer.nativeElement,center:e,zoom:t,accessToken:""}),this.map.on("click",n=>{this.mapClicked.emit([n.lngLat.lng,n.lngLat.lat])}),this.showUserLocation&&this.addUserMarker(e),this.map.on("move",()=>{let n=this.map.getCenter(),o=this.map.getZoom();this.center.set([n.lng,n.lat]),this.centerChange.emit([n.lng,n.lat]),this.zoom.set(o),this.zoomChange.emit(o)})}ngOnDestroy(){this.map&&this.map.remove()}addUserMarker(e){let t=document.createElement("div");t.className="user-location-marker",this.userMarker=new _.default.Marker(t).setLngLat(e).addTo(this.map)}syncMarkers(e){let t=new Set(e.map(n=>n.id));for(let[n,o]of this.mapMarkers.entries())t.has(n)||(o.remove(),this.mapMarkers.delete(n));for(let n of e)this.mapMarkers.has(n.id)?this.mapMarkers.get(n.id).setLngLat([n.lng,n.lat]):this.mapMarkers.set(n.id,this.createMarker(n))}createMarker(e){let t=document.createElement("div");return t.classList.add("map-marker",`marker-${e.type}`),e.type==="waypoint"&&(t.innerText=String((e.order??0)+1)),new _.default.Marker({element:t}).setLngLat([e.lng,e.lat]).addTo(this.map)}drawRoute(e){let t={type:"Feature",geometry:{type:"LineString",coordinates:e}};this.map.getSource(this.routeLayerId)?this.map.getSource(this.routeLayerId).setData(t):(this.map.addSource(this.routeLayerId,{type:"geojson",data:t}),this.map.addLayer({id:this.routeLayerId,type:"line",source:this.routeLayerId,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ff7f50","line-width":5,"line-opacity":.9}}),this.map.addLayer({id:this.routeLayerId+"-arrows",type:"symbol",source:this.routeLayerId,layout:{"symbol-placement":"line","text-field":"\u25B6","text-size":12,"symbol-spacing":60,"text-rotation-alignment":"map"},paint:{"text-color":"#333"}}))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=d({type:i,selectors:[["app-map-component"]],viewQuery:function(t,n){if(t&1&&w(h1,7),t&2){let o;k(o=x())&&(n.mapContainer=o.first)}},hostAttrs:[1,"map-host"],inputs:{center:"center",zoom:"zoom",showUserLocation:"showUserLocation",route:"route",markers:"markers"},outputs:{centerChange:"centerChange",zoomChange:"zoomChange",mapClicked:"mapClicked"},features:[G],decls:7,vars:12,consts:[["mapContainer",""],[1,"toolbar"],["id","map-container"]],template:function(t,n){t&1&&(v(0,"div",1),f(1),D(2,"number"),D(3,"number"),D(4,"number"),F(),q(5,"div",2,0)),t&2&&(r(),i1(" Longitude: ",z(2,3,n.center()[0],"1.4-4")," | Latitude: ",z(3,6,n.center()[1],"1.4-4")," | Zoom: ",z(4,9,n.zoom(),"1.2-2"),`
`))},dependencies:[a1],styles:[`.map-host #map-container{position:absolute;top:0;width:100%;height:500px}.map-host .toolbar{background-color:#23374be6;color:#fff;padding:6px 12px;font-family:monospace;z-index:1;position:absolute;top:0;left:0;margin:12px;border-radius:4px}.map-host .user-location-marker{position:relative;width:20px;height:20px;background-color:#4285f4;border:3px solid white;border-radius:50%;box-shadow:0 0 6px #0000004d;z-index:10}.map-host .map-marker{z-index:99999!important}.map-host .marker-start{width:16px;height:16px;background:#00c853;border-radius:50%;border:3px solid white;box-shadow:0 0 8px #0006}.map-host .marker-end{width:16px;height:16px;background:#d50000;border-radius:50%;border:3px solid white;box-shadow:0 0 8px #0006}.map-host .marker-waypoint{width:14px;height:14px;background:#3b7bff;border-radius:50%;border:2px solid white;box-shadow:0 0 8px #3b7bffcc;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}.map-host .user-location-marker:after{content:"";position:absolute;top:50%;left:50%;width:40px;height:40px;background-color:#4285f44d;border-radius:50%;transform:translate(-50%,-50%);animation:pulse 2s infinite;z-index:-1}@keyframes pulse{0%{transform:translate(-50%,-50%) scale(.7);opacity:.7}50%{transform:translate(-50%,-50%) scale(1.3);opacity:0}to{transform:translate(-50%,-50%) scale(.7);opacity:.7}}
`],encapsulation:2})};var B=class i{http=m(p1);baseUrl="/api/routes";planRoute(e){return this.http.post(`${this.baseUrl}/plan`,e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};function C1(i,e){if(i&1){let t=L();s(0,"div",6),p("click",function(o){let a=I(t).$implicit,H=M(2);return T(H.selectItem(a,o))}),f(1),l()}if(i&2){let t=e.$implicit;r(),o1(" ",t.title," ")}}function b1(i,e){if(i&1&&(s(0,"div",4),y(1,C1,2,1,"div",5),l()),i&2){let t=M();r(),u("ngForOf",t.items)}}var j=class i{label="";items=[];control;isOpen=!1;toggleDropdown(){this.isOpen=!this.isOpen}selectItem(e,t){t.stopPropagation(),this.control.setValue(e.value),this.isOpen=!1}get selectedTitle(){let e=this.items.find(t=>t.value===this.control.value);return e?e.title:"Select"}onClickOutside(e){e.target.closest(".custom-select")||(this.isOpen=!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=d({type:i,selectors:[["pathfinder-single-select"]],hostBindings:function(t,n){t&1&&p("click",function(a){return n.onClickOutside(a)},J)},inputs:{label:"label",items:"items",control:"control"},decls:7,vars:5,consts:[[1,"input-group"],[1,"custom-select",3,"click"],[1,"selected"],["class","dropdown",4,"ngIf"],[1,"dropdown"],["class","option",3,"click",4,"ngFor","ngForOf"],[1,"option",3,"click"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"label"),f(2),l(),s(3,"div",1),p("click",function(){return n.toggleDropdown()}),s(4,"div",2),f(5),l(),y(6,b1,2,1,"div",3),l()()),t&2&&(r(2),O(n.label),r(),n1("open",n.isOpen),r(2),O(n.selectedTitle),r(),u("ngIf",n.isOpen))},dependencies:[s1,U,r1,b],styles:[".input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;width:100%}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#a8c3f0;font-size:14px}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]{position:relative;background:#0f1b33;border:1px solid #2a3e66;border-radius:8px;padding:11px;color:#fff;cursor:pointer;-webkit-user-select:none;user-select:none}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{pointer-events:none}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#0f1b33;border:1px solid #2a3e66;border-radius:8px;margin-top:4px;max-height:200px;overflow-y:auto;z-index:100;scrollbar-width:none;-ms-overflow-style:none}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;height:0}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{padding:10px;cursor:pointer;transition:background .2s}.input-group[_ngcontent-%COMP%]   .custom-select[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]:hover{background:#3b7bff}.input-group[_ngcontent-%COMP%]   .custom-select.open[_ngcontent-%COMP%]{border-color:#3b7bff;box-shadow:0 0 4px #3b7bff80}"]})};var Q=class i{label="";control;disabled=!1;focused=new c;blurred=new c;get coordinatesValue(){let e=this.control.getRawValue();return!e.lat||!e.lng?"":`Lat: ${Number(e.lat).toFixed(6)}, Lng: ${Number(e.lng).toFixed(6)}`}onFocus(){this.focused.emit()}onBlur(){this.blurred.emit()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=d({type:i,selectors:[["pathfinder-coordinate-input"]],inputs:{label:"label",control:"control",disabled:"disabled"},outputs:{focused:"focused",blurred:"blurred"},decls:4,vars:3,consts:[[1,"input-group"],["type","text","readonly","",3,"focus","blur","value","disabled"]],template:function(t,n){t&1&&(v(0,"div",0)(1,"label"),f(2),F(),v(3,"input",1),t1("focus",function(){return n.onFocus()})("blur",function(){return n.onBlur()}),F()()),t&2&&(r(2),O(n.label),r(),e1("value",n.coordinatesValue)("disabled",n.control.disabled||n.disabled))},dependencies:[b],styles:[".input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;width:100%}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#a8c3f0;font-size:14px}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:12px;background:#0f1b33;border:1px solid #2a3e66;border-radius:8px;color:#fff;outline:none;cursor:pointer;transition:border .15s ease,box-shadow .15s ease,background .15s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#3b7bff;box-shadow:0 0 4px #3b7bff80}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{background:#080e1b;border-color:#2a3e6680;color:#ffffff80;cursor:not-allowed;box-shadow:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled:focus{border-color:#2a3e6680;box-shadow:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + label[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]:has(input:disabled)   label[_ngcontent-%COMP%]{color:#a8c3f080}"]})};function y1(i,e){if(i&1){let t=L();X(0),s(1,"div",12)(2,"pathfinder-coordinate-input",13),p("focused",function(){let o=I(t).index,a=M();return T(a.setFocus({type:"waypoint",index:o}))}),l()(),K()}if(i&2){let t=e.$implicit,n=e.index;r(2),u("label","Waypoint "+(n+1))("control",t)}}var S=class i{filtersChange=new c;focusedField=new c;submitFilters=new c;fb=m(m1);destroyRef=m(E);geoService=m(N);routeForm=this.fb.group({routeType:new C("CIRCULAR",{nonNullable:!0}),start:new C({lat:null,lng:null}),waypoints:this.fb.array([]),end:new C({lat:null,lng:null},{}),duration:new C(30)});routeTypes=[{title:"Circular route",value:"CIRCULAR"},{title:"From A to B",value:"A_TO_B"}];durationOptions=[{title:"30 min",value:30},{title:"60 min",value:60},{title:"2 hours",value:120}];get waypoints(){return this.routeForm.controls.waypoints}ngOnInit(){this.routeForm.controls.end.disable({emitEvent:!1}),this.initStartPoint(),this.subOnFormValueChanges(),this.subOnRouteTypeChanges(),this.subOnStartPointValueChanges(),this.filtersChange.emit(this.routeForm.getRawValue())}subOnFormValueChanges(){this.routeForm.valueChanges.pipe(g(this.destroyRef)).subscribe(e=>{this.filtersChange.emit(e)})}initStartPoint(){this.geoService.getCurrentPosition().pipe(g(this.destroyRef)).subscribe({next:e=>{this.routeForm.controls.start.setValue({lat:e.coords.latitude,lng:e.coords.longitude})},error:e=>{console.warn("Could not get user location",e)}})}subOnRouteTypeChanges(){this.routeForm.controls.routeType.valueChanges.pipe(g(this.destroyRef)).subscribe(e=>{e==="CIRCULAR"?(this.routeForm.controls.end.disable({emitEvent:!1}),console.log(this.routeForm.controls.end.disabled),this.routeForm.controls.end.setValue(this.routeForm.controls.start.value,{emitEvent:!1})):this.routeForm.controls.end.enable({emitEvent:!1})})}subOnStartPointValueChanges(){this.routeForm.controls.start.valueChanges.pipe(g(this.destroyRef)).subscribe(e=>{this.routeForm.controls.routeType.value==="CIRCULAR"&&this.routeForm.controls.end.setValue(e,{emitEvent:!1})})}setFocus(e){this.focusedField.emit(e)}addWaypoint(){this.waypoints.push(new C({lat:null,lng:null},{nonNullable:!0}))}removeWaypoint(e){this.waypoints.removeAt(e)}setCoordinate(e,t){e&&(e.type==="start"&&this.routeForm.controls.start.setValue(t),e.type==="end"&&this.routeForm.controls.end.setValue(t),e.type==="waypoint"&&this.waypoints.at(e.index).setValue(t))}onSubmitClick(){this.submitFilters.emit(this.routeForm.getRawValue())}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=d({type:i,selectors:[["app-route-filters-section"]],outputs:{filtersChange:"filtersChange",focusedField:"focusedField",submitFilters:"submitFilters"},decls:12,vars:8,consts:[[1,"route-filters"],[1,"route-filters__params"],["label","Route type",3,"items","control"],["label","Duration",3,"items","control"],["label","Start",3,"focused","control"],[1,"waypoints"],[4,"ngFor","ngForOf"],[1,"waypoints__button"],["text","+ Add waypoint",3,"onClick"],["label","End",3,"focused","control","disabled"],[1,"route-filters__submit"],["text","Find route",3,"onClick"],[1,"waypoints__item"],[3,"focused","label","control"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"div",1),W(2,"pathfinder-single-select",2)(3,"pathfinder-single-select",3),l(),s(4,"pathfinder-coordinate-input",4),p("focused",function(){return n.setFocus({type:"start"})}),l(),s(5,"div",5),y(6,y1,3,2,"ng-container",6),s(7,"div",7)(8,"pathfinder-button",8),p("onClick",function(){return n.addWaypoint()}),l()()(),s(9,"pathfinder-coordinate-input",9),p("focused",function(){return n.setFocus({type:"end"})}),l(),s(10,"div",10)(11,"pathfinder-button",11),p("onClick",function(){return n.onSubmitClick()}),l()()()),t&2&&(r(2),u("items",n.routeTypes)("control",n.routeForm.controls.routeType),r(),u("items",n.durationOptions)("control",n.routeForm.controls.duration),r(),u("control",n.routeForm.controls.start),r(2),u("ngForOf",n.waypoints.controls),r(3),u("control",n.routeForm.controls.end)("disabled",n.routeForm.controls.end.disabled))},dependencies:[j,Q,U,u1],styles:[".route-filters[_ngcontent-%COMP%]{width:100%;max-width:360px;background:#0d1a35;border-radius:12px;padding:24px;box-shadow:0 4px 20px #0006;border:1px solid #2a3e66;display:flex;flex-direction:column;gap:16px}.route-filters__params[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-column-gap:16px}.section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#a8c3f0;text-transform:uppercase;letter-spacing:.8px;margin-bottom:8px}.waypoints[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.waypoints__item[_ngcontent-%COMP%]{margin-bottom:16px;width:100%}.waypoints__button[_ngcontent-%COMP%]{width:max-content}"]})};var d1=class i{mapComponent;filtersComponent;routePlannerService=m(B);center=h([-98.54818,40.00811]);zoom=h(3.2);showUserLocation=!0;timePeriods=[{title:"30 minutes",value:30},{title:"1 hour",value:60},{title:"2 hours",value:120},{title:"5 hours",value:300},{title:"Custom",value:"custom"}];route=V;markers=[];activeField=null;submitRoute(e){this.routePlannerService.planRoute(e).subscribe(t=>{this.route={type:"LineString",coordinates:t.data.geometry.coordinates??[],duration:t.data.durationMinutes??0,distance:t.data.distanceMeters??0},this.mapComponent.drawRoute(t.data.geometry.coordinates??[])})}onCenterChange(e){this.center.set(e)}onZoomChange(e){this.zoom.set(e)}onMapClick(e){if(!this.activeField)return;let[t,n]=e;this.filtersComponent.setCoordinate(this.activeField,{lat:n,lng:t})}getControl(e,t){return e?.get(t)}onFiltersChange(e){console.log(e);let t=[];if(e.start){let[n,o]=[e.start.lat,e.start.lng];t.push({id:"start",type:"start",lat:n,lng:o})}if(e.waypoints?.forEach((n,o)=>{let[a,H]=[n.lat,n.lng];t.push({id:`wp-${o}`,type:"waypoint",lat:a,lng:H,order:o})}),e.routeType==="CIRCULAR"){this.markers=t;return}if(e.end){let[n,o]=[e.end.lat,e.end.lng];t.push({id:"end",type:"end",lat:n,lng:o})}this.markers=t}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=d({type:i,selectors:[["app-find-route-page"]],viewQuery:function(t,n){if(t&1&&(w(P,5),w(S,5)),t&2){let o;k(o=x())&&(n.mapComponent=o.first),k(o=x())&&(n.filtersComponent=o.first)}},decls:5,vars:5,consts:[[1,"find-route-wrapper"],[1,"controls-panel"],[3,"filtersChange","focusedField","submitFilters"],[1,"map-wrapper"],[3,"centerChange","zoomChange","mapClicked","center","zoom","showUserLocation","route","markers"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"div",1)(2,"app-route-filters-section",2),p("filtersChange",function(a){return n.onFiltersChange(a)})("focusedField",function(a){return n.activeField=a})("submitFilters",function(a){return n.submitRoute(a)}),l()(),s(3,"div",3)(4,"app-map-component",4),p("centerChange",function(a){return n.onCenterChange(a)})("zoomChange",function(a){return n.onZoomChange(a)})("mapClicked",function(a){return n.onMapClick(a)}),l()()()),t&2&&(r(4),u("center",n.center)("zoom",n.zoom)("showUserLocation",n.showUserLocation)("route",n.route)("markers",n.markers))},dependencies:[b,P,S],styles:[".find-route-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;gap:24px;height:100%}.find-route-wrapper[_ngcontent-%COMP%]   app-map-component[_ngcontent-%COMP%]{flex:1;width:100%;height:100%}"]})};export{d1 as FindRoutePageComponent};
